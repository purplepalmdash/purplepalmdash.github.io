<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Tips on 30Days30Skills(5) &#183; Dash</title><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-a.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/custom-additions.css?ref=abc124"><link rel=stylesheet href=https://purplepalmdash.github.io/css/highlight/googlecode.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script type=text/javascript src=/js/html2canvas.js></script><script type=text/javascript>function genPostShot(){var rightNow=new Date();var imageName=rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");imageName+='.jpg'
html2canvas(document.getElementsByClassName('post'),{background:'#FFFFFF',onrendered:function(canvas){$('#test').attr('href',canvas.toDataURL("image/jpeg"));$('#test').attr('download',imageName);$('#test')[0].click();}});};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124"><link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel=icon><meta name=description content><meta name=keywords content="unix,virtualization,embedded,linux"></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><img src=http://purplepalmdash.github.io/images/mylogo.jpeg alt=gravatar><h1><a href=http://purplepalmdash.github.io/>Get busy living, or get busy dying.</a></h1><a href=http://purplepalmdash.github.io/><p>Dash</p></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/post/>All Posts</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/technology/>Technology</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/life/>Life</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/linuxtips/>LinuxTips</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/purplepalmdash><i class="fa fa-github-square fa-3x"></i></a><a href=https://cn.linkedin.com/in/yang-feipeng-1b909319><i class="fa fa-linkedin-square fa-3x"></i></a><a href=https://plus.google.com/u/0/106572959364703833986><i class="fa fa-google-plus-square fa-3x"></i></a><a href=https://www.facebook.com/yang.feipeng><i class="fa fa-facebook-square fa-3x"></i></a><a href=https://twitter.com/dashwillfly><i class="fa fa-twitter-square fa-3x"></i></a></li></ul></div></div><div class="content container"><div class=post><h1>Tips on 30Days30Skills(5)</h1><p align=right><a href=javascript:genPostShot()>TurnToJPG --> <i class="fa fa-camera-retro fa-2x"></i></a><a id=test></a></p><hr><span class=post-date>Dec 6, 2014<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><div id=_toc class=toc><nav id=TableOfContents><ul><li><ul><li><a href=#day-12---opencv>Day 12 - OpenCV</a></li><li><a href=#day-13---dropwizard>Day 13 - Dropwizard</a></li></ul></li></ul></nav></div><p>Since the RESTful API is a little bit hard for setup, I ignore the Day10 and Day11, jump to Day 12, OpenCV.</p><h3 id=day-12---opencv>Day 12 - OpenCV</h3><h4 id=get-the-jar-file>Get the jar file</h4><p>First download the opencv from:
<a href=http://sourceforge.net/projects/opencvlibrary/files/latest/download>http://sourceforge.net/projects/opencvlibrary/files/latest/download</a></p><pre><code>$ unzip *.zip
$ cd opencv-2.4.10
$ cmake -G &quot;Unix Makefiles&quot; -D CMAKE_CXX_COMPILER=/usr/bin/g++ -D CMAKE_C_COMPILER=/usr/bin/gcc -D WITH_CUDA=ON .. 
$ make -j4 &amp;&amp; make install

</code></pre><p>Trouble shooting when generating openCV jar file:<br>Correct output should be:</p><pre><code>--   Java:
--     ant:                         /bin/ant (ver 1.9.4)
--     JNI:                         /usr/lib/jvm/java-7-openjdk/include /usr/lib/jvm/java-7-openjdk/include/linux /usr/lib/jvm/java-7-openjdk/include
--     Java tests:                  YES

</code></pre><p>Add JNi</p><pre><code>export JAVA_HOME=/usr/lib/jvm/java-7-openjdk/

</code></pre><p>Then build with following command:</p><pre><code>$ cmake -G &quot;Unix Makefiles&quot; -D CMAKE_CXX_COMPILER=/usr/bin/g++ -D CMAKE_C_COMPILER=/usr/bin/gcc -D WITH_CUDA=ON -D BUILD_SHARED_LIBS=OFF -D BUILD_NEW_PYTHON_SUPPORT=NO .. &amp;&amp; make

</code></pre><p>For MACOS, you should install:</p><pre><code>$ brew install ant
$ export JAVA_HOME=`/usr/libexec/java_home -v 1.6`

</code></pre><p>Then re-compile and now you could get the jar file under build/bin/.</p><h4 id=development-on-opencv>Development on OpenCV</h4><p>Using eclipse LUNA.</p><pre><code>(venv)[Trusty@~/code/30days/Day12OpenCV/opencv-2.4.10/build/bin]$ pwd
/home/Trusty/code/30days/Day12OpenCV/opencv-2.4.10/build/bin
(venv)[Trusty@~/code/30days/Day12OpenCV/opencv-2.4.10/build/bin]$ ls *.jar
opencv-2410.jar

</code></pre><p>Add the new User Libraries:</p><p><img src=/images/addjavalib.jpg alt=/images/addjavalib.jpg></p><p>The detailed configuration steps could be refered to the <a href=http://segmentfault.com/a/1190000000358809>http://segmentfault.com/a/1190000000358809</a>, After configuration your User Libraries should be looked like this:<br><img src=/images/javalib2.jpg alt=/images/javalib2.jpg></p><p>Add User Libraries thus you could see the configuration of the lib is looked like:<br><img src=/images/libconfiguration.jpg alt=/images/libconfiguration.jpg></p><p>Code is like following:</p><pre><code>package facedetection;
import org.opencv.core.Core;
import org.opencv.core.Mat;
import org.opencv.core.MatOfRect;
import org.opencv.core.Point;
import org.opencv.core.Rect;
import org.opencv.core.Scalar;
import org.opencv.highgui.Highgui;
import org.opencv.objdetect.CascadeClassifier;

public class MyFaceDetectionClass {
    public static void main(String[] args) {

        System.loadLibrary(Core.NATIVE_LIBRARY_NAME);
        System.out.println(&quot;\nRunning FaceDetector&quot;);

        CascadeClassifier faceDetector = new CascadeClassifier(MyFaceDetectionClass.class.getResource(&quot;haarcascade_frontalface_alt.xml&quot;).getPath());
        Mat image = Highgui
                .imread(MyFaceDetectionClass.class.getResource(&quot;shekhar.JPG&quot;).getPath());

        MatOfRect faceDetections = new MatOfRect();
        faceDetector.detectMultiScale(image, faceDetections);

        System.out.println(String.format(&quot;Detected %s faces&quot;, faceDetections.toArray().length));

        for (Rect rect : faceDetections.toArray()) {
            Core.rectangle(image, new Point(rect.x, rect.y), new Point(rect.x + rect.width, rect.y + rect.height),
                    new Scalar(0, 255, 0));
        }

        String filename = &quot;ouput.png&quot;;
        System.out.println(String.format(&quot;Writing %s&quot;, filename));
        Highgui.imwrite(filename, image);
    }
}

</code></pre><p>Then you should place the xml file and the JPG file under the java class, after doing this, run the application, then you will got the png file generate with face detected.</p><h3 id=day-13---dropwizard>Day 13 - Dropwizard</h3><p>First you should install mondb in ArchLinux:</p><pre><code>$ sudo pacman -S mongodb

</code></pre><p>Then in eclipse, create a new Maven project with the template of &ldquo;maven-archetype-quickstart&rdquo;, with the following configuration of Artifact Id and Group id.<br><img src=/images/blogjava.jpg alt=/images/blogjava.jpg></p><p>The default pom.xml should be modified,</p><p>Since the network environment is not stable, I created a vncserver at the VPS, and use VPS for developing.<br>In vps:</p><pre><code>sudo apt-get install eclipse
sudo apt-get install mongodb

</code></pre><p>then install the maven from: <a href=http://download.eclipse.org/technology/m2e/releases/1.3>http://download.eclipse.org/technology/m2e/releases/1.3</a></p></div></div><script src=http://purplepalmdash.github.io/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>