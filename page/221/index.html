<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta name=generator content="Hugo 0.64.0"><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Dash &#183; Dash</title><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-a.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/custom-additions.css?ref=abc124"><link rel=stylesheet href=https://purplepalmdash.github.io/css/highlight/googlecode.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script type=text/javascript src=/js/html2canvas.js></script><script type=text/javascript>function genPostShot(){var rightNow=new Date();var imageName=rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");imageName+='.jpg'
html2canvas(document.getElementsByClassName('post'),{background:'#FFFFFF',onrendered:function(canvas){$('#test').attr('href',canvas.toDataURL("image/jpeg"));$('#test').attr('download',imageName);$('#test')[0].click();}});};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124"><link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel=icon><link href=%7balternate%20%7bRSS%20application/rss+xml%20%20index%20alternate%20%20false%20false%20true%20false%20false%200%7d%20/index.xml%20http://purplepalmdash.github.io/index.xml%7d rel=alternate type=application/rss+xml title="Dash &#183; Dash"><meta name=description content><meta name=keywords content="unix,virtualization,embedded,linux"></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><img src=http://purplepalmdash.github.io/images/mylogo.jpeg alt=gravatar><h1><a href=http://purplepalmdash.github.io/>很惭愧，就做了一点微小的工作</a></h1><a href=http://purplepalmdash.github.io/><p>Dash</p></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/post/>All Posts</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/technology/>Technology</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/life/>Life</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/linuxtips/>LinuxTips</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/purplepalmdash><i class="fa fa-github-square fa-3x"></i></a><a href=https://cn.linkedin.com/in/yang-feipeng-1b909319><i class="fa fa-linkedin-square fa-3x"></i></a><a href=https://plus.google.com/u/0/106572959364703833986><i class="fa fa-google-plus-square fa-3x"></i></a><a href=https://www.facebook.com/yang.feipeng><i class="fa fa-facebook-square fa-3x"></i></a><a href=https://twitter.com/dashwillfly><i class="fa fa-twitter-square fa-3x"></i></a></li></ul></div></div><div class="content container"><div class=posts><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/2013/11/16/hmc5883l-on-raspberrypi/>HMC5883L on RaspberryPI</a></h1><span class=post-date>Nov 16, 2013<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>###Make sure you have installed i2c tools
Install i2c-tools via:</p><pre><code>	# apt-get install i2c-tools
	# apt-cache search i2c-tools
	i2c-tools - heterogeneous set of I2C tools for Linux
</code></pre><p>Check if spi and i2c has been blacklisted in system:</p><pre><code>	# cat  /etc/modprobe.d/raspi-blacklist.conf 
	# blacklist spi and i2c by default (many users don't need them)
	
	blacklist spi-bcm2708
	blacklist i2c-bcm2708

</code></pre><p>Comment out them, now your i2c will not be blacklisted.<br>Add following items into /etc/modules:</p><pre><code>	i2c-bcm2708
	i2c-dev

</code></pre><p>Enable the user to access i2c equipments in user space:</p><pre><code>	root@rasp:~# cat /etc/udev/rules.d/99-i2c.rules 
	SUBSYSTEM==”i2c-dev”, MODE=”0666″

</code></pre><p>Reboot and check the result.</p><pre><code>	root@rasp:~# ls /dev/i2c*
	/dev/i2c-0  /dev/i2c-1

</code></pre><p>Now your i2c equipments become available. Detect the attached equipments:</p><pre><code>	root@rasp:~# i2cdetect -y 0
	     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f
	00:          -- -- -- -- -- -- -- -- -- -- -- -- -- 
	10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- 1e -- 
	20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
	30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
	40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
	50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
	60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
	70: -- -- -- -- -- -- -- -- 

</code></pre><p>###Install Think Bowl I2C libraries for Python
For setting up the python library please input following lines:</p><pre><code>	cd code/
	mkdir i2c
	cd i2c/
	git clone https://github.com/quick2wire/quick2wire-python-api.git
	export QUICK2WIRE_API_HOME=~/code/i2c/quick2wire-python-api/
	export PYTHONPATH=$PYTHONPATH:$QUICK2WIRE_API_HOME
	mkdir pythoncode
	cd pythoncode/
	git clone https://bitbucket.org/thinkbowl/i2clibraries.git

</code></pre><p>###Wiring:</p><pre><code>| Pi pin number | Pi pin name 	| HMC5883L pin name  	|
| ------ 	| ------	| -----: 		|
|  1		|  3V3		|   VCC			|
|  6		|  Ground	|   GND			|
|  3		|  SDA		|   SDA			|
|  5		|  SCL		|   SCL			|


</code></pre><p>###Python code</p><pre><code>	vim test-sensor.py
	python3 test-sensor.py 

</code></pre><p>test-sensor.py should be like following:</p><pre><code>#!/usr/bin/python3
from i2clibraries import i2c_hmc5883l
hmc5883l = i2c_hmc5883l.i2c_hmc5883l(0)
hmc5883l.setContinuousMode()
hmc5883l.setDeclination(9,54)
print(hmc5883l)
</code></pre><p>Result should be shown as following:</p><pre><code>	root@rasp:~/code/i2c/pythoncode# python3 test-sensor.py 
	Axis X: 311.88
	Axis Y: 160.08
	Axis Z: -300.84
	Declination: 9° 54'
	Heading: 37° 4'

</code></pre></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/2013/11/16/vmware-vmci-problem/>VMware VMCI problem</a></h1><span class=post-date>Nov 16, 2013<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>Edit the file /etc/init.d/vmware with your favorite text editor, change the definition:</p><pre><code>	vmwareLoadModule &quot;$mod&quot;
</code></pre><p>Change this line to</p><pre><code>	vmwareLoadModule &quot;$vmci&quot;
</code></pre><p>Then Navigate to the other function vmwareLoadModule &ldquo;$mod&rdquo; Under the function definition.</p><pre><code>	vmwareLoadModule &quot;$mod&quot;
</code></pre><p>Change this line to</p><pre><code>	vmwareLoadModule &quot;$vsock&quot;
</code></pre><p>Now we need to find the corresponding Module Unload functions Under the Function vmwareStopVmci()
Change</p><pre><code>	vmwareUnloadModule &quot;${mod}&quot; 
</code></pre><p>to</p><pre><code>	vmwareUnloadModule &quot;${vmci}&quot;
</code></pre><p>Under the function vmwareStopVsock() Change</p><pre><code>	vmwareUnloadModule &quot;$mod&quot;  
</code></pre><p>to</p><pre><code>	vmwareUnloadModule &quot;$vsock&quot;
</code></pre><p>Once done I would suggest reboot your machine although not necessary.<br>Post that run sudo /etc/init.d/vmware start</p><pre><code>	Starting VMware services:
	   Virtual machine monitor                                             done
	   Virtual machine communication interface                             done
	   VM communication interface socket family                            done
	   Blocking file system                                                done
	   Virtual ethernet                                                    done
	   VMware Authentication Daemon                                        done
	   Shared Memory Available                                             done
</code></pre><p>and now you can see vmware workstation works fine and you are able to power on your virtual machines, and connect to network fine.</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/2013/11/15/building-poll-circuit-on-eaglebone/>Building Poll circuit on EagleBone</a></h1><span class=post-date>Nov 15, 2013<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>###Background Knowledge
三极管（NPN型）的用法很简单（半圆形平的一面朝自己，引脚朝下），左边接电源中间为触发极，右边输出，有点像开关，只要中间的脚有微弱电流触发，就如同开关被打开，电流就会从左边流向右边。</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/2013/11/14/compile-linux-kernel-for-beaglebone/>Compile Linux kernel for Beaglebone</a></h1><span class=post-date>Nov 14, 2013<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>###SourceCode Preparation
1. Get the latest code of beaglebone kernel:</p><pre><code>	git clone git://github.com/RobertCNelson/linux-dev.git
</code></pre><p>2. Check for your cross-compiler:</p><pre><code>	$ which arm-linux-gnueabi-gcc
	/media/y/embedded/gcc-linaro-arm-linux-gnueabi-2012.02-20120222_linux/bin/arm-linux-gnueabi-gcc
</code></pre><p>3. Start a new branch</p><pre><code>	$ git checkout origin/am33x-v3.2 -b am33x-v3.2
	Branch am33x-v3.2 set up to track remote branch am33x-v3.2 from origin.
	Switched to a new branch 'am33x-v3.2'
</code></pre><p>Since the latest kernel has been moved 3.12, we have to checkout am33x-v3.12</p><pre><code>	$ git checkout origin/am33x-v3.12 -b am33x-v3.12
</code></pre><p>You also have to manually download the latest kernel source code from github:</p><pre><code>	$ git clone git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git
</code></pre><p>###Configure everything before compilation
Edit the system.sh file</p><pre><code>	$ cp system.sh.sample system.sh
</code></pre><p>The system.sh should have following lines:</p><pre><code>	echo &quot;Using: Cross Compiler&quot;
	CC=arm-linux-gnueabi-
	##For TI: OMAP3/4/AM35xx
	ZRELADDR=0x80008000
	#LINUX_GIT=/home/user/linux-stable/
	LINUX_GIT=/media/x/bbBlack/linux/git/linux-stable/
</code></pre><p>Then run ./build_kernel.sh to see your kernel is under compiling, you will be prompted to asked &ldquo;make menuconfig&rdquo;, choose whatever you want.Wait patiently until all of your compilation is done.<br>###Install kernel
Edit the destination for your installation, edit the file &ldquo;system.sh&rdquo;:</p><pre><code>	MMC=/dev/mmcblk0 
	# or whatever you found in your own system.
</code></pre><p>Then you simply input ./tools/install_kernel.sh, you will be asked some questions, answer then and your kernel will be installed to your sd card. Now use the SD card for booting system, you will get a brand-new system.
###Install Filesystem
Download the pre-configured filesystems from:</p><pre><code>	# For example, download the quantal related image, that's 12.10.
	$ wget http://rcn-ee.net/deb/rootfs/quantal/ubuntu-12.10-console-armhf-2013-07-22.tar.xz
	$ unxz ubuntu-12.10-console-armhf-2013-07-22.tar.xz
	$ tar xvf ubuntu-12.10-console-armhf-2013-07-22.tar
</code></pre><p>Then insert your SD card, simply input:</p><pre><code>	# take BeagleBoneBlack for example:
	$ sudo ./setup_sdcard.sh --mmc /dev/sdX --uboot bone
</code></pre><p>After setup SD card, using the newly configured SD card for booting up the system, you will get the new system running the pre-configured rootfs.</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/2013/11/14/irremote-on-arduino/>IRRemote on Arduino</a></h1><span class=post-date>Nov 14, 2013<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>###Preparation of the IRremote library
Using the downloaded,</p><pre><code>	Trusty@SomethingMissing:~/code/arduino/arduino-1.0.5/libraries$ cp -r ../../library/Arduino_IRremote_master/ ./
	Trusty@SomethingMissing:~/code/arduino/arduino-1.0.5/libraries$ pwd
	/home/Trusty/code/arduino/arduino-1.0.5/libraries
</code></pre><p>Or using git the get the latest one, in fact this one is not new at all , it updates 2 years ago.</p><pre><code>	$ git clone git://github.com/shirriff/Arduino-IRremote.git
</code></pre><p>Now we can use it for programming.
###Programming
insert the code and verify the result.</p><pre><code>	#include &lt;IRremote.h&gt;  // 使用IRRemote函数库
	 
	const int irReceiverPin = 2;  // 红外接收器的 OUTPUT 引脚接在 PIN2 接口 定义irReceiverPin变量为PIN2接口
	 
	IRrecv irrecv(irReceiverPin); // 设置irReceiverPin定义的端口为红外信号接收端口
	decode_results results;    // 定义results变量为红外结果存放位置
	 
	void setup()
	{
	  Serial.begin(9600);   // 开启串口，波特率为9600
	  irrecv.enableIRIn();   // 启动红外解码
	}
	 
	void loop() 
	{
	  if (irrecv.decode(&amp;results)) {   // 解码成功，把数据放入results变量中
	    // 把数据输入到串口
	    Serial.print(&quot;irCode: &quot;);            
	    Serial.print(results.value, HEX); // 显示红外编码
	    Serial.print(&quot;,  bits: &quot;);           
	    Serial.println(results.bits); // 显示红外编码位数
	    irrecv.resume();    // 继续等待接收下一组信号
	  }  
	  delay(600); //延时600毫秒，做一个简单的消抖
	}
</code></pre><p>###Verification
See the wired image:</p><p><img src=/images/wired.png alt=wired.png></p><p>Then see how to connect the sensor:</p><p><img src=/images/sensors.jpg alt=sensors.jpg></p><p>Now see the result:</p><p><img src=/images/IrRemote.png alt=IrRemote.png></p><p>###Seeing the light
Now we can use IRremote for controlling our mp3 player. Because it only occupy 1 GPIO, and it could support so many combinations, we can use it to control the player&rsquo;s activities.</p></div><ul class=pagination><li class=page-item><a href=/ class=page-link aria-label=First><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/page/220/ class=page-link aria-label=Previous><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a class=page-link href=/>1</a></li><li class=page-item><a class=page-link href=/page/2/>2</a></li><li class=page-item><a class=page-link href=/page/3/>3</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/220/>220</a></li><li class="page-item active"><a class=page-link href=/page/221/>221</a></li><li class=page-item><a class=page-link href=/page/222/>222</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/238/>238</a></li><li class=page-item><a href=/page/222/ class=page-link aria-label=Next><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/page/238/ class=page-link aria-label=Last><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div><script src=http://purplepalmdash.github.io/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>