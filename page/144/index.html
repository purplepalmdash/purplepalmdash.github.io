<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta name=generator content="Hugo 0.64.0"><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Dash &#183; Dash</title><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-a.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/custom-additions.css?ref=abc124"><link rel=stylesheet href=https://purplepalmdash.github.io/css/highlight/googlecode.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script type=text/javascript src=/js/html2canvas.js></script><script type=text/javascript>function genPostShot(){var rightNow=new Date();var imageName=rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");imageName+='.jpg'
html2canvas(document.getElementsByClassName('post'),{background:'#FFFFFF',onrendered:function(canvas){$('#test').attr('href',canvas.toDataURL("image/jpeg"));$('#test').attr('download',imageName);$('#test')[0].click();}});};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124"><link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel=icon><link href=%7balternate%20%7bRSS%20application/rss+xml%20%20index%20alternate%20%20false%20false%20true%20false%20false%200%7d%20/index.xml%20http://purplepalmdash.github.io/index.xml%7d rel=alternate type=application/rss+xml title="Dash &#183; Dash"><meta name=description content><meta name=keywords content="unix,virtualization,embedded,linux"></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><img src=http://purplepalmdash.github.io/images/mylogo.jpeg alt=gravatar><h1><a href=http://purplepalmdash.github.io/>Get busy living, or get busy dying.</a></h1><a href=http://purplepalmdash.github.io/><p>Dash</p></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/post/>All Posts</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/technology/>Technology</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/life/>Life</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/linuxtips/>LinuxTips</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/purplepalmdash><i class="fa fa-github-square fa-3x"></i></a><a href=https://cn.linkedin.com/in/yang-feipeng-1b909319><i class="fa fa-linkedin-square fa-3x"></i></a><a href=https://plus.google.com/u/0/106572959364703833986><i class="fa fa-google-plus-square fa-3x"></i></a><a href=https://www.facebook.com/yang.feipeng><i class="fa fa-facebook-square fa-3x"></i></a><a href=https://twitter.com/dashwillfly><i class="fa fa-twitter-square fa-3x"></i></a></li></ul></div></div><div class="content container"><div class=posts><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/2015/02/03/install-gitlab-and-gogs/>Install GitLab And Gogs</a></h1><span class=post-date>Feb 3, 2015<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>For sharing the git managed codes, we need setup the online repositories, we got two options, one is for gitlab, the other is for gogs.</p><h3 id=gitlab>Gitlab</h3><p>The reference URL is listed as in:<br><a href=https://www.digitalocean.com/community/tutorials/how-to-set-up-gitlab-as-your-very-own-private-github-clone>https://www.digitalocean.com/community/tutorials/how-to-set-up-gitlab-as-your-very-own-private-github-clone</a><br>But following the tutorial you will met the problem, following records the solution:</p><pre><code>$ sudo -u git -H bundle install --deployment --without development test postgres
   Could not find modernizr-2.6.2 in any of the sources
$ cd /home/git/gitlab
$ wget http://rubygems.org/downloads/modernizr-2.6.2.gem
$ sudo gem install modernizr
$ vim Gemfile
gem &quot;modernizr&quot;    &quot;2.6.2&quot;   ===&gt; gem &quot;modernizr-rails&quot;,        &quot;2.7.1&quot;
$ vim Gemfile.lock
modernizr  (2.6.2)   ===&gt;     modernizr-rails (2.7.1)
modernizr  (2.6.2)   ===&gt;     modernizr-rails (= 2.7.1)
$ sudo -u git -H bundle install --deployment --without development test postgres 

</code></pre><h3 id=gogs>Gogs</h3><p>We use docker for installing Gogs, the command listed as following:</p><pre><code># sh -c &quot;wget -qO- https://get.docker.io/gpg | apt-key add -&quot;
# sh -c &quot;echo deb http://get.docker.io/ubuntu docker main\
&gt; /etc/apt/sources.list.d/docker.list&quot;
# apt-get update
# apt-get install lxc-docker
# proxychains4 docker pull codeskyblue/docker-gogs

</code></pre><p>This pull back the <code>docker-gogs</code> image, later you could run the gogs server via:</p><pre><code>$ mkdir /var/gogs
$ docker run -d -p 2223:22 -p 3000:3000 -v /var/gogs:/data codeskyblue/docker-gogs

</code></pre><p>Then visit <code>http://1xx.xx.xx.xxx:3000</code> you will got the installation webpage, simply install it.<br>Everytime you run into error case, you could remove the <code>/var/gogs</code> directory and let everything happen from zero.</p><h3 id=using-gogs>Using Gogs</h3><p>Create Repository, then <code>git clone</code>, then add your own files, <code>git add .</code>, <code>git commit -m</code>, <code>git push origin master</code>, the same as you did in github.</p><p>Some problems happens&mldr;. We changed to OpenSuse for installing.<br>Remove all of the .git directory in sub-directories via following command, then problem won&rsquo;t happen.</p><pre><code>find ./* -name &quot;.git&quot; | xargs rm -rf

</code></pre><p>Now git push all of the changes to the remote repository and you got everything works well.<br>Add the running command into <code>/etc/rc.local</code> thus the docker runs together with the system startup.</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/2015/02/03/prison-break-for-something/>Prison-Break For Something</a></h1><span class=post-date>Feb 3, 2015<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>I&rsquo;ve worked two days on prison-break something, this will greatly improve my working efficiency. There are so many steps for recording, so I will detailed described them in following parts.</p><h3 id=single-mode>Single MOde</h3><p>In Single Mode you could get an terminal with root then you could do anything you want, simply pass <code>init=/bin/bash</code> in Grub then you could do anything.<br>Question: why Unix-like system enable this command?<br>Answer: In Unix-like systems, init is the first process to be run, and the ultimate ancestor of all processes ever run. It&rsquo;s responsible for running all the init scripts.<br>We could add sudo users, with sudo users, you could get more priviledges.</p><h3 id=privoxy>privoxy</h3><p>This fantanstic software could let you setup your own proxy server, simply compile it and let it run under user <code>root</code>, after it starts up, a proxy which listens on 8118 will be available for using.</p><h3 id=system-upgrade>System Upgrade</h3><p>!!!Notice!!!: Always keep at least 2 root loginned terminal alive, thus if any problem happens you could do debugging.<br>Since you have the privoxy for using proxy, you could do anything you want, you could upgrade system from default 11.3 to the latest 13.2. The reference URLs are listed as following:<br>Upgrade from 11.3 to 12.3:<br><a href=https://zh.opensuse.org/SDB:%E7%B3%BB%E7%BB%9F%E5%8D%87%E7%BA%A7>https://zh.opensuse.org/SDB:%E7%B3%BB%E7%BB%9F%E5%8D%87%E7%BA%A7</a><br>Main tips:</p><pre><code>$ sudo zypper addrepo --check --name 'openSUSE-11.3-Update' http://download.opensuse.org/update/11.3/repo-update
$ sudo zypper ref &amp;&amp; zypper update
$ sudo reboot
.....
$ sudo zypper mr -da
$ sudo zypper ar -f http://download.openSUSE.org/distribution/12.3/repo/oss/ openSUSE:12.3:OSS
$ sudo zypper ar -f http://download.openSUSE.org/distribution/12.3/repo/non-oss/ openSUSE:12.3:NON-OSS
$ sudo zypper addlock liblzma0
$ sudo zypper dup --download &quot;in-advance&quot;
$ sudo shutdown -hP now                                                                                                                       

</code></pre><p>Upgrade from 11.3 to 12.3 won&rsquo;t cause any problems, and on my machine the new system become available for using immediately.<br>Upgrade from 12.3 to 13.2:<br><a href=https://en.opensuse.org/SDB:System_upgrade>https://en.opensuse.org/SDB:System_upgrade</a><br>Main tips:</p><pre><code>$ sudo zypper addrepo --check --name 'openSUSE-12.3-Update' http://download.opensuse.org/update/12.3/repo-update
$ sudo zypper ref &amp;&amp; zypper update
$ sudo reboot
.....
$ sudo zypper mr -da
$ sudo zypper ar -f http://download.openSUSE.org/distribution/13.2/repo/oss/ openSUSE:13.2:OSS
$ sudo zypper ar -f http://download.openSUSE.org/distribution/13.2/repo/non-oss/ openSUSE:13.2:NON-OSS
$ sudo zypper addlock liblzma0
$ sudo zypper dup --download &quot;in-advance&quot;
$ sudo shutdown -hP now

</code></pre><p>Trouble shooting:<br>1. When upgrading the system, zypper will halt(hang) at following packages:<br>zypper dup locks up Bug #802525. Workaround: make sure to keep a root shell open while zypper dup is running. Run &ldquo;killall dbus-send&rdquo; when zypper dup hangs at rtkit.<br><a href=https://en.opensuse.org/openSUSE:Most_annoying_bugs_13.1_dev>https://en.opensuse.org/openSUSE:Most_annoying_bugs_13.1_dev</a><br>2. tuned installation got stuck:</p><pre><code>$ ps -ef | grep tuned
$ kill tunned
$ ps -ef | grep rpm 
$ kill greped_rpm_install

</code></pre><h3 id=route>Route</h3><p>References:<br><a href=http://w.gdu.me/wiki/Linux/iptables_forward_internetshare.html>http://w.gdu.me/wiki/Linux/iptables_forward_internetshare.html</a><br>First in the middleware machine, add following rules in iptables:</p><pre><code># iptables -P FORWARD ALLOW
# iptables -A FORWARD -m state --state ESTABLISHED,RELATED -j ACCEPT
# iptables -t nat -A POSTROUTING -s 10.1.1.0/24 -j SNAT --to 60.1.1.1
# iptables -A FORWARD -s 10.1.1.9 -j ACCEPT

</code></pre><p>Now you could use this middle machine for acrossing something.<br>But, in your own machine, should use the following command for deleting the routes and add new routes:</p><pre><code># route del default gw xxx.xxx.xxx.xxx
# route add default gw xxx.xxx.xxx.xxx

</code></pre><p>There are also some complicated commands for holding the routes, but we could also edit the following files:</p><pre><code># pwd
/etc/sysconfig/network
linux:/etc/sysconfig/network # cat routes 
default xxx.xx.xxx.xxx - - 
any net xxx.xx.0.0 netmask 255.255.0.0 gw xxx.xxx.xxx.200

</code></pre><p>Now even if you reboot the machine, the default route and the exchange route will be also added into the system.</p><h3 id=more-safer>More Safer</h3><p>Change the opensshd listenning port.<br>More and more.</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/2015/01/31/try-opencontrail-in-ubuntu/>Try OpenContrail In Ubuntu</a></h1><span class=post-date>Jan 31, 2015<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>To be write</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/2015/01/30/speed-up-the-wp-website-in-tianchao/>Speed-Up the WP website in TianChao</a></h1><span class=post-date>Jan 30, 2015<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>Since our Great Fire Wall forbidden the google, thus all of the google related service becomes available in china, this leads to access to wordpress based website which uses google online fonts pretty slow. Following is how to speedup your website without too many changes:<br>First go to your website&rsquo;s folder, find the files which calls <code>fonts.googleapis.com</code>:</p><pre><code>$ grep -i &quot;fonts.googleapis.com&quot; ./ -r
./wp-content/themes/twentytwelve/functions.php:		$font_url = add_query_arg( $query_args, &quot;$protocol://fonts.googleapis.com/css&quot; );
./wp-content/themes/twentyfifteen/functions.php:		), '//fonts.googleapis.com/css' );
./wp-content/themes/twentyfourteen/functions.php:		$font_url = add_query_arg( 'family', urlencode( 'Lato:300,400,700,900,300italic,400italic,700italic' ), &quot;//fonts.googleapis.com/css&quot; );
./wp-content/themes/tdpersona/functions.php:	wp_enqueue_style( 'tdpersona-googlefonts', '//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700' );
./wp-content/themes/twentythirteen/functions.php:		$fonts_url = add_query_arg( $query_args, &quot;//fonts.googleapis.com/css&quot; );
./wp-includes/script-loader.php:		$open_sans_font_url = &quot;//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,300,400,600&amp;subset=$subsets&quot;;
./wp-includes/js/tinymce/plugins/compat3x/css/dialog.css:@import url(//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,300,400,600&amp;subset=latin-ext,latin);


</code></pre><p>Replace all of the <code>fonts.googleapis.com</code> with <code>fonts.useso.com</code>, this could be done via scripts.<br>After modification, your website will be much more faster than before.</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/2015/01/29/build-contrial-source-code/>Build Contrial Source Code</a></h1><span class=post-date>Jan 29, 2015<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=reference>Reference</h3><p><a href=http://juniper.github.io/contrail-vnc/README.html>http://juniper.github.io/contrail-vnc/README.html</a></p><h3 id=hardware--software>Hardware && Software</h3><p>Vitualized machine which have 1G memory and 1 core.<br>Running 12.04:</p><pre><code># cat /etc/issue
Ubuntu 12.04.3 LTS \n \l

</code></pre><h3 id=packages>Packages</h3><p>You should install following packages:</p><pre><code>$ sudo add-apt-repository ppa:opencontrail/ppa
$ sudo vim /etc/apt/source.lists
deb http://ppa.launchpad.net/opencontrail/ppa/ubuntu precise main
deb-src http://ppa.launchpad.net/opencontrail/ppa/ubuntu precise main
$ sudo apt-get install  -y scons git python-lxml wget gcc patch make unzip flex bison g++ libssl-dev autoconf automake libtool pkg-config vim python-dev python-setuptools libprotobuf-dev protobuf-compiler libsnmp-python libgettextpo0 libxml2-utils debhelper python-sphinx ruby-ronn libipfix python-all libpcap-dev module-assistant libtbb-dev libboost-dev liblog4cplus-dev libghc-curl-dev
$ sudo apt-get install python-pip
$ sudo pip install gevent bottle netaddr 

</code></pre><h3 id=getting-source-code>Getting Source Code</h3><p>Use repo for getting the source code:</p><pre><code>$ curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo
$ chmod a+x ~/bin/repo
$ echo &quot;export PATH=/usr/local/git/bin:$PATH&quot;&gt;&gt;~/.bashrc
$ source ~/.bashrc

</code></pre><p>Fetch the repository and sync it.</p><pre><code>$ mkdir ~/Code/OpenContrail
$ cd ~/Code/OpenContrail
$ repo init -u git@github.com:Juniper/contrail-vnc
$ repo sync

</code></pre><p>Some of the packages will be blocked by GFW, be sure you use proxy for downloading them.<br>Fetch the third party packages:</p><pre><code>$ python third_party/fetch_packages.py

</code></pre><h3 id=build-the-opencontrail--pakages>Build the OpenContrail & Pakages</h3><p>The build step is simply via <code>scons</code>, after a long wait, it will pass.<br>Generate packages via:</p><pre><code>$ make -f packages.make

</code></pre><p>The default configuration will make <code>all</code> of the components in packages.make, or you could seperately build single component.</p></div><ul class=pagination><li class=page-item><a href=/ class=page-link aria-label=First><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/page/143/ class=page-link aria-label=Previous><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a class=page-link href=/>1</a></li><li class=page-item><a class=page-link href=/page/2/>2</a></li><li class=page-item><a class=page-link href=/page/3/>3</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/143/>143</a></li><li class="page-item active"><a class=page-link href=/page/144/>144</a></li><li class=page-item><a class=page-link href=/page/145/>145</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/223/>223</a></li><li class=page-item><a href=/page/145/ class=page-link aria-label=Next><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/page/223/ class=page-link aria-label=Last><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div><script src=http://purplepalmdash.github.io/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>