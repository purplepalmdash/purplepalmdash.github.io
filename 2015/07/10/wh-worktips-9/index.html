<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>WH Worktips(9) &#183; Dash</title><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-a.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/custom-additions.css?ref=abc124"><link rel=stylesheet href=https://purplepalmdash.github.io/css/highlight/googlecode.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script type=text/javascript src=/js/html2canvas.js></script><script type=text/javascript>function genPostShot(){var rightNow=new Date();var imageName=rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");imageName+='.jpg'
html2canvas(document.getElementsByClassName('post'),{background:'#FFFFFF',onrendered:function(canvas){$('#test').attr('href',canvas.toDataURL("image/jpeg"));$('#test').attr('download',imageName);$('#test')[0].click();}});};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124"><link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel=icon><meta name=description content><meta name=keywords content="unix,virtualization,embedded,linux"></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><img src=http://purplepalmdash.github.io/images/mylogo.jpeg alt=gravatar><h1><a href=http://purplepalmdash.github.io/>Get busy living, or get busy dying.</a></h1><a href=http://purplepalmdash.github.io/><p>Dash</p></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/post/>All Posts</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/technology/>Technology</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/life/>Life</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/linuxtips/>LinuxTips</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/purplepalmdash><i class="fa fa-github-square fa-3x"></i></a><a href=https://cn.linkedin.com/in/yang-feipeng-1b909319><i class="fa fa-linkedin-square fa-3x"></i></a><a href=https://plus.google.com/u/0/106572959364703833986><i class="fa fa-google-plus-square fa-3x"></i></a><a href=https://www.facebook.com/yang.feipeng><i class="fa fa-facebook-square fa-3x"></i></a><a href=https://twitter.com/dashwillfly><i class="fa fa-twitter-square fa-3x"></i></a></li></ul></div></div><div class="content container"><div class=post><h1>WH Worktips(9)</h1><p align=right><a href=javascript:genPostShot()>TurnToJPG --> <i class="fa fa-camera-retro fa-2x"></i></a><a id=test></a></p><hr><span class=post-date>Jul 10, 2015<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><div id=_toc class=toc><nav id=TableOfContents><ul><li><ul><li><a href=#cobbler-in-non-dhcp-server-networking>Cobbler In Non-DHCP Server Networking</a></li><li><a href=#cobbler-in-the-existing-dhcp-enabled-network>Cobbler in the existing DHCP enabled Network</a></li><li><a href=#cobbler-server-image-to-new-network>Cobbler Server Image To New Network</a></li></ul></li></ul></nav></div><h3 id=cobbler-in-non-dhcp-server-networking>Cobbler In Non-DHCP Server Networking</h3><p>Sometimes you want to deploy system with cobbler server, in some restricted network which dhcp service is not allowed(considering broadcasting storm, security, etc.) Following are the steps of how-to:<br>Change Cobbler server setting:</p><pre><code>$ sudo vim /etc/cobbler/settings
manage_dhcp: 0
$ sudo cobbler sync
$ sudo service dhcpd stop
</code></pre><p>Add the node definition in cobbler(useless):</p><pre><code># cobbler system add --name=node2 --profile=CentOS6.5-x86_64 --mac=52:54:00:71:59:64 --interface=eth0 --static=1 --ip-address=10.47.58.3 --dns-name=node2 --gateway=10.47.58.1
</code></pre><p>Now bootup your newly added computer with PXE, hit <code>ctrl+B</code> once you see the bios hint.</p><pre><code>iPXE&gt; config net0
</code></pre><p>hit <code>ctrl+B</code> should be like in following image:<br><img src=/images/2015_07_10_20_31_15_761x354.jpg alt=/images/2015_07_10_20_31_15_761x354.jpg></p><p><img src=/images/2015_07_10_20_26_29_656x381.jpg alt=/images/2015_07_10_20_26_29_656x381.jpg><br>Setting like following:<br><img src=/images/2015_07_10_20_33_15_676x453.jpg alt=/images/2015_07_10_20_33_15_676x453.jpg><br>Hit <code>Ctrl+x</code> for saving the settings and continue to set:</p><pre><code>iPXE&gt; imgfetch -n img tftp://10.47.58.2/pxelinux.0
iPXE&gt; imgload img
iPXE&gt; boot
</code></pre><p>Now begin to install, you will met nework configuration fail issue:<br><img src=/images/2015_07_10_20_39_30_580x240.jpg alt=/images/2015_07_10_20_39_30_580x240.jpg></p><p>Hit Cancel, manually set up the network, first select installation method:<br><img src=/images/2015_07_10_20_41_12_323x273.jpg alt=/images/2015_07_10_20_41_12_323x273.jpg></p><p>Configure TCP/IP:<br><img src=/images/2015_07_10_20_42_14_430x286.jpg alt=/images/2015_07_10_20_42_14_430x286.jpg><br>Configure IP address/gateway/dns/netmask:<br><img src=/images/2015_07_10_20_43_08_600x280.jpg alt=/images/2015_07_10_20_43_08_600x280.jpg><br>Now configure the installation setting, you could find it in your own ks configuration file:<br><img src=/images/2015_07_10_20_44_22_585x334.jpg alt=/images/2015_07_10_20_44_22_585x334.jpg></p><p>Continue to install, they are the same as you did before.</p><h3 id=cobbler-in-the-existing-dhcp-enabled-network>Cobbler in the existing DHCP enabled Network</h3><p>Since the dhcp server is available in the network, simply press <code>ctrl+B</code> to enter the pxe boot menu and set the <code>next_server</code> to <code>10.47.58.2</code>, then:</p><pre><code>iPXE&gt; imgfetch -n img tftp://10.47.58.2/pxelinux.0
iPXE&gt; imgload img
iPXE&gt; boot
</code></pre><p>Now select whichever you want to deploy, your configuration will be deployed ASAP.</p><h3 id=cobbler-server-image-to-new-network>Cobbler Server Image To New Network</h3><p>You have to change following items:</p><ol><li>IP address.</li><li>dhcp templates</li><li>Next Server Name.</li></ol><pre><code>$ sudo vim /etc/cobbler/settings
next_server: 172.16.10.2
server: 172.16.10.2
$ sudo vim /etc/cobbler/dhcp.templates
subnet 172.16.10.0 netmask 255.255.255.0 {
     option routers             172.16.10.1; 
     range dynamic-bootp        172.16.10.3 172.16.10.254;
     option domain-name-servers 114.114.114.114, 180.76.76.76;     
     option subnet-mask         255.255.255.0;         
     filename                   &quot;/pxelinux.0&quot;;       
     default-lease-time         21600;           
     max-lease-time             43200;      
     next-server                $next_server; 
     class &quot;pxeclients&quot; {

//..................
$ sudo vim /etc/default/isc-dhcp-server
INTERFACES=&quot;eth0&quot;
</code></pre><p>Notice the IP address should be in the same ip address range.</p><p>After modification, simply use <code>cobbler sync</code> for syncing your changes, now restart the cobbler server, your operation should be the same as the above situations.</p><p>Also if you have playbooks of ansible which uses the static IP address, you also have to replace the IP related settings.</p></div></div><script src=http://purplepalmdash.github.io/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>